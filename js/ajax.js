function AjaxRequest(b,j){if(b!=null){try{if(b.indexOf(cleanBaseURL)==0){b.replace(cleanBaseURL,siteBaseUrl)}}catch(h){}if(b.indexOf("?action=")>-1){var c=new Date();b=b+"&differentAjaxReqCounter="+c.getUTCDate()+c.getHours()+c.getMinutes()+c.getSeconds()+c.getUTCMilliseconds()}}var d;var a=j;if(window.XMLHttpRequest){d=new XMLHttpRequest();if(d.overrideMimeType){d.overrideMimeType("text/html")}}else{if(window.ActiveXObject){try{d=new ActiveXObject("Msxml2.XMLHTTP")}catch(g){try{d=new ActiveXObject("Microsoft.XMLHTTP")}catch(g){try{d=new XMLHttpRequest()}catch(g){}}}}}var i=function(){if(d.readyState==4){try{if(d.status==200){if(a.update){var e=jQuery.getOne(a.update);e.innerHTML=d.responseText;executeLoadedScript(e)}if(a.onComplete){a.onComplete(d,a.returnArgs)}AjaxUtil.remove(a.ajaxId)}else{if(a.onError){a.onError()}}}catch(k){if(a.onError){a.onError()}}}};var f=function(l){var e=l.split("?");var o=e[0];var n=e[1];try{if(n==null){n=""}}catch(m){}try{if(a.method=="get"){d.open("GET",l,true);d.onreadystatechange=i;d.send("")}else{d.open("POST",o,true);d.setRequestHeader("Method","POST "+o+" HTTP/1.1");d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.onreadystatechange=i;d.send(n)}}catch(k){if(a.onError){a.onError()}}};f(b);this.resend=function(k,e){a=e;f(k)};this.getId=function(){return ajaxId};this.cleanUp=function(){d.onreadystatechange=function(){};i=null;returnArgs=null;d=null};this.abort=function(){d.abort()}}var AjaxUtil={counter:1,requests:new Array(),request:function(c,b){var e=(b==null)?(new Object()):b;var a=(e.reverseAjax)?0:AjaxUtil.getNextId();e.ajaxId=a;var d;if(a==0&&AjaxUtil.requests[0]){d=AjaxUtil.requests[0];d.resend(c,e)}else{d=new AjaxRequest(c,e);AjaxUtil.requests[a]=d}if(!e.onComplete&&!e.update){AjaxUtil.remove(a)}},submit:function(e,c){var b=e.action;var a=jQuery("input, textarea, select",e);var d=c||new Object();var f=a.serialize();if(b.indexOf("?")==-1){b=b+"?"+f}if(b.lastIndexOf("?")==b.length-1){b=b+f}else{b=b+"&"+f}if(d.disable){a.attr("disabled",true)}AjaxUtil.request(b,d)},update:function(b,d,a){var c=a||new Object();c.update=d;AjaxUtil.request(b,c)},getNextId:function(){var a=AjaxUtil.counter++;if(AjaxUtil.counter>20){AjaxUtil.counter=1}return a},remove:function(b){if(b){var a=AjaxUtil.requests[b];if(a){a.cleanUp();a=null}}},abort:function(b){if(b){var a=AjaxUtil.requests[b];if(a){a.abort();a=null}}}};function executeLoadedScript(el){var scripts=el.getElementsByTagName("script");for(var i=0;i<scripts.length;i++){if(scripts[i].src){var head=document.getElementsByTagName("head")[0];var scriptObj=document.createElement("script");scriptObj.setAttribute("type","text/javascript");scriptObj.setAttribute("src",scripts[i].src);head.appendChild(scriptObj)}else{try{if(jQuery.browser.safari){eval(scripts[i].innerHTML)}else{if(jQuery.browser.mozilla){eval(scripts[i].textContent)}else{eval(scripts[i].text)}}}catch(e){}}}}function loadPage(c,d,b,a){AjaxUtil.request(c+"?"+d,{onComplete:b,returnArgs:a})}function printJSON(a){if(a&&a.id){var b=document.getElementById(a.id);if(b){b.innerHTML=a.toString()}}};